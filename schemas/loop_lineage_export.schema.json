{
  "$schema": "http:
  "title": "Loop Lineage Export Schema",
  "description": "Schema for loop lineage export data in various formats",
  "type": "object",
  "required": ["loop_id", "export_timestamp", "loop_info", "lineage"],
  "properties": {
    "loop_id": {
      "type": "string",
      "description": "Unique identifier for the loop",
      "pattern": "^loop_[0-9a-zA-Z]+$"
    },
    "export_timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp of when the export was created",
      "format": "date-time"
    },
    "loop_info": {
      "type": "object",
      "description": "Information about the loop",
      "required": ["loop_id", "timestamp", "status", "orchestrator_persona", "alignment_score", "drift_score", "rerun_count", "summary"],
      "properties": {
        "loop_id": {
          "type": "string",
          "description": "Unique identifier for the loop",
          "pattern": "^loop_[0-9a-zA-Z]+$"
        },
        "timestamp": {
          "type": "string",
          "description": "ISO 8601 timestamp of when the loop was created",
          "format": "date-time"
        },
        "status": {
          "type": "string",
          "description": "Current status of the loop",
          "enum": ["draft", "active", "finalized", "archived", "error"]
        },
        "orchestrator_persona": {
          "type": "string",
          "description": "Persona of the orchestrator that created the loop"
        },
        "alignment_score": {
          "type": "number",
          "description": "Alignment score of the loop (0.0 to 1.0)",
          "minimum": 0.0,
          "maximum": 1.0
        },
        "drift_score": {
          "type": "number",
          "description": "Drift score of the loop (0.0 to 1.0)",
          "minimum": 0.0,
          "maximum": 1.0
        },
        "rerun_count": {
          "type": "integer",
          "description": "Number of times the loop has been rerun",
          "minimum": 0
        },
        "summary": {
          "type": "string",
          "description": "Summary of the loop's content"
        },
        "rerun_trigger": {
          "type": "array",
          "description": "Triggers that caused the loop to be rerun",
          "items": {
            "type": "string",
            "enum": ["alignment", "drift", "safety", "user", "system", "other"]
          }
        },
        "rerun_reason": {
          "type": "string",
          "description": "Reason the loop was rerun"
        }
      }
    },
    "lineage": {
      "type": "object",
      "description": "Lineage information for the loop",
      "required": ["parent_id", "child_ids", "ancestor_ids", "descendant_ids", "sibling_ids"],
      "properties": {
        "parent_id": {
          "type": ["string", "null"],
          "description": "ID of the parent loop, or null if no parent"
        },
        "child_ids": {
          "type": "array",
          "description": "IDs of child loops",
          "items": {
            "type": "string",
            "pattern": "^loop_[0-9a-zA-Z]+$"
          }
        },
        "ancestor_ids": {
          "type": "array",
          "description": "IDs of ancestor loops",
          "items": {
            "type": "string",
            "pattern": "^loop_[0-9a-zA-Z]+$"
          }
        },
        "descendant_ids": {
          "type": "array",
          "description": "IDs of descendant loops",
          "items": {
            "type": "string",
            "pattern": "^loop_[0-9a-zA-Z]+$"
          }
        },
        "sibling_ids": {
          "type": "array",
          "description": "IDs of sibling loops",
          "items": {
            "type": "string",
            "pattern": "^loop_[0-9a-zA-Z]+$"
          }
        }
      }
    }
  },
  "additionalProperties": False,
  "examples": [
    {
      "loop_id": "loop_001",
      "export_timestamp": "2025-04-22T10:30:00Z",
      "loop_info": {
        "loop_id": "loop_001",
        "timestamp": "2025-04-20T10:00:00Z",
        "status": "finalized",
        "orchestrator_persona": "SAGE",
        "alignment_score": 0.82,
        "drift_score": 0.18,
        "rerun_count": 0,
        "summary": "Analyzed quantum computing concepts with thorough examination of qubits, superposition, and entanglement."
      },
      "lineage": {
        "parent_id": null,
        "child_ids": ["loop_002"],
        "ancestor_ids": [],
        "descendant_ids": ["loop_002"],
        "sibling_ids": []
      }
    }
  ]
}
