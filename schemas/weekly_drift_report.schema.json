{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Weekly Drift Report Schema",
  "description": "Schema for weekly system-level drift reports that aggregate signals across multiple loops",
  "type": "object",
  "required": [
    "report_id",
    "loop_range",
    "drift_summary_stats",
    "belief_engagement",
    "trust_trend",
    "mode_usage",
    "recommendation",
    "timestamp"
  ],
  "properties": {
    "report_id": {
      "type": "string",
      "description": "Unique identifier of the weekly drift report"
    },
    "loop_range": {
      "type": "array",
      "description": "List of loop IDs included in this report",
      "items": {
        "type": "string"
      },
      "minItems": 1
    },
    "drift_summary_stats": {
      "type": "object",
      "description": "Aggregated statistics from drift summaries",
      "required": [
        "avg_drift_score",
        "critical_drift_count",
        "common_biases"
      ],
      "properties": {
        "avg_drift_score": {
          "type": "number",
          "description": "Average drift score across all loops (0.0 to 1.0)",
          "minimum": 0.0,
          "maximum": 1.0
        },
        "critical_drift_count": {
          "type": "integer",
          "description": "Number of critical drift incidents in the reporting period",
          "minimum": 0
        },
        "common_biases": {
          "type": "array",
          "description": "List of bias tags that appeared multiple times",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "belief_engagement": {
      "type": "object",
      "description": "Metrics about belief references and engagement",
      "required": [
        "most_referenced",
        "least_referenced"
      ],
      "properties": {
        "most_referenced": {
          "type": ["string", "null"],
          "description": "The belief that was most frequently referenced"
        },
        "least_referenced": {
          "type": ["string", "null"],
          "description": "The belief that was least frequently referenced"
        }
      }
    },
    "trust_trend": {
      "type": "object",
      "description": "Metrics about system trust and health",
      "required": [
        "avg_health_score",
        "avg_trust_decay"
      ],
      "properties": {
        "avg_health_score": {
          "type": "number",
          "description": "Average health score across all loops (0.0 to 1.0)",
          "minimum": 0.0,
          "maximum": 1.0
        },
        "avg_trust_decay": {
          "type": "number",
          "description": "Average trust decay across all loops (0.0 to 1.0)",
          "minimum": 0.0,
          "maximum": 1.0
        }
      }
    },
    "mode_usage": {
      "type": "object",
      "description": "Counts of different modes used during the reporting period",
      "additionalProperties": {
        "type": "integer",
        "minimum": 0
      }
    },
    "recommendation": {
      "type": "string",
      "description": "Recommended action based on the aggregated metrics"
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp when the report was generated",
      "format": "date-time"
    }
  },
  "additionalProperties": false
}
